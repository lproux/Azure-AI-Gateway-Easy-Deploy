=== WORKING NOTEBOOK: Cell 2 (Initialization for 2 servers) ===
# Cell 2: MCP Client Initialization (Updated for 2 Real Servers)

import sys
sys.path.append('.')

from notebook_mcp_helpers import MCPClient, MCPError

# Check if already initialized (prevent re-initialization)
if 'mcp' in globals() and hasattr(mcp, 'excel'):
    print("âš ï¸  MCP Client already initialized. Skipping re-initialization.")
    print(f"   Excel MCP: {mcp.excel.server_url}")
    print(f"   Docs MCP: {mcp.docs.server_url}")
else:
    print("ðŸ”„ Initializing MCP Client...")
    try:
        mcp = MCPClient()
        print("âœ… MCP Client initialized successfully!")
        print(f"")
        print(f"ðŸ“¡ Real MCP Servers Deployed:")
        print(f"   1. Excel Analytics: {mcp.excel.server_url}")
        print(f"   2. Research Documents: {mcp.docs.server_url}")
        print(f"")
        print(f"ðŸ’¡ Note: Only 2 real MCP servers are deployed from workshop.")
        print(f"   Other servers (weather, oncall, etc.) were placeholder images.")
    except Exception as e:
        print(f"âŒ Failed to initialize MCP Client: {e}")
        raise


=== WORKING NOTEBOOK: Cell 3 (Initialization for 5 servers) ===
# Cell 2: MCP Client Initialization (Updated for 5 Real Servers)
import sys
sys.path.append('.')

from notebook_mcp_helpers import MCPClient, MCPError

# Check if already initialized with ALL 5 servers (prevent re-initialization)
if 'mcp' in globals() and hasattr(mcp, 'excel') and hasattr(mcp, 'docs') and hasattr(mcp, 'weather') and hasattr(mcp, 'oncall') and hasattr(mcp, 'spotify'):
    print("âš ï¸  MCP Client already initialized with all 5 servers. Skipping re-initialization.")
    print(f"   Excel MCP: {mcp.excel.server_url}")
    print(f"   Docs MCP: {mcp.docs.server_url}")
    print(f"   Weather MCP: {mcp.weather.server_url}")
    print(f"   OnCall MCP: {mcp.oncall.server_url}")
    print(f"   Spotify MCP: {mcp.spotify.server_url}")
else:
    if 'mcp' in globals():
        print("ðŸ”„ MCP Client needs update (adding OnCall & Spotify MCPs)...")
        del mcp  # Delete old instance
    else:
        print("ðŸ”„ Initializing MCP Client...")

    try:
        mcp = MCPClient()
        print("âœ… MCP Client initialized successfully!")
        print()
        print(f"ðŸ“¡ Deployed MCP Servers:")
        print(f"   1. Excel Analytics: {mcp.excel.server_url}")
        print(f"   2. Research Documents: {mcp.docs.server_url}")
        print(f"   3. Weather: {mcp.weather.server_url}")
        print(f"   4. OnCall: {mcp.oncall.server_url}")
        print(f"   5. Spotify: {mcp.spotify.server_url}")
        print()
        print(f"ðŸ’¡ Note: 5 real MCP servers are deployed.")
        print(f"   - Excel & Docs: JSON-RPC on port 8000")
        print(f"   - Weather, OnCall & Spotify: SSE transport on port 8080")
    except Exception as e:
        print(f"âŒ Failed to initialize MCP Client: {e}")
        import traceback
        traceback.print_exc()
        raise


=== FINAL NOTEBOOK: Cell 9 (Unified MCP Initialization) ===
# (-1.8) Unified MCP Initialization
"""Initializes required MCP servers in a single pass.
ENV-driven variables (if present):
  GITHUB_MCP_URL, WEATHER_MCP_URL, PRODUCT_CATALOG_MCP_URL, ONCALL_MCP_URL, SPOTIFY_MCP_URL
Gracefully skips any server whose client helper isn't available.
Creates a global dict MCP_SERVERS with name->client.
"""
import os
MCP_SERVERS={}

# Mapping env key -> (friendly_name, import_path, class_name)
SERVER_SPECS=[
    ('GITHUB_MCP_URL', ('github','notebook_mcp_helpers','GitHubMCP')),
    ('WEATHER_MCP_URL', ('weather','notebook_mcp_helpers','WeatherMCP')),
    ('PRODUCT_CATALOG_MCP_URL', ('product_catalog','notebook_mcp_helpers','ProductCatalogMCP')),
    ('ONCALL_MCP_URL', ('oncall','notebook_mcp_helpers','OnCallMCP')),
    ('SPOTIFY_MCP_URL', ('spotify','notebook_mcp_helpers','SpotifyMCP')),
]
loaded=0
for env_key,(short,mod,class_name) in SERVER_SPECS:
    url=os.environ.get(env_key)
    if not url:
        continue
    try:
        module=__import__(mod, fromlist=[class_name])
        cls=getattr(module,class_name)
        client=cls(url)
        MCP_SERVERS[short]=client
        loaded+=1
        print(f'[mcp] {short} -> {url}')
    except Exception as e:
        print(f'[mcp] Failed {short}: {e}')
print(f'[mcp] Initialized {loaded} server(s)')